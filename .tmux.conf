# ==========================
# 1. Change prefix to Ctrl+a
# ==========================
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# ==========================
# 2. Enable mouse support
# ==========================
set -g mouse on

# ==========================
# 3. Alt-key pane controls (no prefix needed)
# ==========================
# Alt+h/j/k/l: Navigate panes
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Alt+Shift+h/j/k/l: Create pane in that direction
bind -n M-H split-window -hb  # new pane to the left
bind -n M-L split-window -h   # new pane to the right
bind -n M-J split-window -v   # new pane below
bind -n M-K split-window -vb  # new pane above

# Alt+c: Clear screen and scrollback history
bind -n M-c send-keys -R \; clear-history

# Alt+w: Close current pane
bind -n M-w kill-pane

# Alt+Shift+w: Close current window
bind -n M-W kill-window

# Alt+n/p: Next/previous window
bind -n M-n next-window
bind -n M-p previous-window

# Alt+t: New window
bind -n M-t new-window

# Alt+f: Open tmux-fzf
bind -n M-f run-shell -b "~/.tmux/plugins/tmux-fzf/main.sh"

# ==========================
# 4. Status bar theme
# ==========================
set -g status-position bottom
set -g status-style 'bg=#282a36 fg=#f8f8f2'

# Left side: session name and user@host
set -g status-left-length 50
set -g status-left '#[bg=#6272a4 fg=#f8f8f2 bold] #S #[bg=#44475a] #(whoami)@#H #[bg=#282a36] '

# Right side: date and time
set -g status-right-length 50
set -g status-right '#[fg=#f8f8f2] %a %b %d #[bg=#6272a4 fg=#f8f8f2 bold] %H:%M '

# Window tabs (shows pane count if more than 1)
set -g window-status-format ' #I:#W#{?#{>:#{window_panes},1},[#{window_panes}],} '
set -g window-status-current-format '#[bg=#44475a fg=#f8f8f2 bold] #I:#W#{?#{>:#{window_panes},1},[#{window_panes}],} #[bg=#6272a4]#{?#{>:#{window_panes},1}, P#{pane_index},}#[bg=#282a36] '

# Pane borders
set -g pane-border-style 'fg=#44475a'
set -g pane-active-border-style 'fg=#6272a4'

# Show pane indices in borders
set -g pane-border-status top
set -g pane-border-format ' #{pane_index}: #{pane_current_command} '

# ==========================
# Quality of life extras
# ==========================
# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer
set -g history-limit 10000

# Reduce escape delay (better for vim)
set -sg escape-time 10

# Enable true color support
set -g default-terminal "screen-256color"
set -sa terminal-features ',xterm-256color:RGB'

# ==========================
# Plugins (TPM)
# ==========================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'sainnhe/tmux-fzf'

# tmux-fzf settings
TMUX_FZF_LAUNCH_KEY="f"

# Initialize TPM (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
